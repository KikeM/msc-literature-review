%% Lab Report for EEET2493_labreport_template.tex
%% V1.0
%% 2019/01/16
%% This is the template for a Lab report following an IEEE paper. Modified by Francisco Tovar after Michael Sheel original document.


%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall the IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%*************************************************************************

% Theoretical
% A literature review is often the foundation for a theoretical framework. 
% You can use it to discuss various theories, models, and definitions of key concepts.
% You might argue for the relevance of a specific theoretical approach, 
% or combine various theoretical concepts to create a framework for your research.
In the following, we present the relevant literature used in this work.
% We have preferred to group references by conceptual blocks, 
% and towards the end bridge all of them together.
We have used mainly two types of papers: 
methodology and applications.
The former present a numerical method or formulation 
which we use, 
the latter make use of it for specific applications.
We were especially interested in the applications to see how
previous works dealt with inhomogeneous boundary conditions,
on which will be discussed later on in the work and the review.

% Uncomment for thesis.tex
\subsubsection{Burgers Terms and Piston Models}
% Uncomment for literature_review.tex
% \subsection{Burgers Terms and Piston Models}
Regarding the target PDE to work with, we decided upon several constraints:
it had to be one-dimensional (to ease implementation), 
contain non-trivial terms (to make the problem interesting),
and be physically sound (to validate the outcome).

The first two constraints are satisfied by an advection equation with 
a nonlinear Burgers-like convective term.
The Burgers equation showed up in the gas dynamics literature several decades ago
\cite{BURGERS1948171,
moran_shen_1966,
1969nonlinearWavePropagationInARelaxingGas,
1951_quasiLinearParabolicEquationOcuringAerodynamics},
for which under controlled conditions 
a range of implicit analytical solutions exist \cite{1972_TableSolutionsBurgers},
including for moving domains \cite{2000_burgersMovingDomainAnalytical}.

Nevertheless, most of the mentioned solutions are either asymptotic,
computed in a moving frame of reference\footnote{
    It is important to make the distinction between a \textit{moving domain}
    and a \textit{moving coordinate system}.
    The former is deformed around the same neighborhood in space,
    whilst the latter is displacing itself across space.
}, 
or defined for an infinite or fixed domain.
Additionally, to obtain results integral formulations have to be solved 
(the simple solutions are only defined for fixed domains).
Hence, it could become cumbersome to attempt to replicate
the results found in these papers.

Luckily, removing viscosity and body forces (which are strong assumptions), 
and making use of the isentropic condition,
we can transform the Navier-Stokes equations 
into a one-dimensional equation \cite{1860_Earnshow, nonlinearDiffusiveWaves}
in terms of velocity.
At the discretization level though, 
we will add an artificial viscosity term,
to make sure the solution remains stable \cite{2011_artificialViscosityPOD}.

This result is a simple yet complete PDE to model the movement of a piston, 
which can be validated with derived computations such as mass conservation,
and whose solution makes intuitively sense when plotted.

Compared to modern problems with moving domains,
the piston is quite simple in nature;
and yet it allowed many aerodynamicists to push forward the barrier of knowledge 
back in the days, when computational power was not so easy to access 
\cite{1956_PistonTheoryNewAerodynamicTool}. 

% Uncomment for thesis.tex
\subsubsection{Deforming Mesh (ALE)}
% Uncomment for literature_review.tex
% \subsection{Deforming Mesh (ALE)}
\label{sec:literature_review_deforming_mesh}
% Finding the right literature for the Arbitrary Lagrangian Eulerian (ALE) formulation 
% was more difficult than expected.
Because the piston problem is a defined in a moving domain,
one needs to modify the departing PDE to account for the movement 
of the mesh nodes, with the introduction of a convective term 
governed by the mesh velocity vector.
In fact, this needs to be done even for domains with fixed boundaries, 
where the interior mesh nodes move in time 
(front-tracking or shock-capturing schemes could be an example
of such situations).
This leads to the Arbitrary Lagrangian Eulerian (ALE) formulation.

% There is a lot 
% but most of it is focused at defining the complete transformation,
% (how to solve a moving domain with a fixed mesh),
% or the complete fluid and/or solid mechanics equations.
% Since we want to remain in the physical domain
% (for a \mbox{single-variable} PDE),
% we had the intuition that only
% an additional convective term had to be defined, 
% to account for mesh displacement.
% Additionally, some sources do not make the explicit distinction between
% conservative and non-conservative formulations.

An introduction to the details of the ALE formulation in a simple setting
can be found in
\cite{formaggiaALE,
formaggiaALE_secondOrder,
FSIPistonProblem}.
In these works, stability arguments and implementation details for finite elements
and simple PDE models are provided.
%In fact, we must point out how helpful the work \cite{formaggiaALE}
%turned out to be.
Work \cite{formaggiaALE} contains lengthy and easy-to-read derivations which explain neatly
the differences between conservative and non-conservative weak forms.
For reasons that will become aparent later on,
in this thesis we need to solve the \mbox{non-conservative} weak form,
at least to use the current formulation of the system aproximation technique which 
we intend to use.

For a complete and generic development of the subject,
in higher dimensions and for complex problems,
we refer the reader to 
\cite{doneaALE,
DONEA1982689}.

Regarding the stability of the integration scheme,
the concept of \textit{(Discrete) Geometric Conservation Law} (D-GCL) shows up 
\cite{HUGHES2000467,
GUILLARD20001467,
FARHAT2001669,
LESOINNE199671}.
Briefly, how the domain deforms and how this deformation is accounted for
\textit{in the discretization} of the continuous problem,
could lead or not to instabilities in the solution; 
for the movement of the mesh could introduce artificial fluxes in the discretization.
As a general rule of thumb, 
to guarantee some notion of stability,
the scheme should be able to reproduce the constant solution 
(under the appropriate boundary conditions).
% \mytodo{Reference: GCL, what happens if the constant solution is not preserved.}

This D-GCL condition can be further explored for simple problems.
In \cite{formaggiaALE} they prove how the Implicit Euler integration scheme
becomes conditionally stable for a linear advection-diffusion problem
if the non-conservative weak formulation is solved.
So in a way, the worst case scenario would be that we have to lower the time step.

As a final note, 
we would like to point out that a problem with a deforming domain
could also be tackled with \mbox{space-time} finite elements 
\cite{TEZDUYAR1992339}.
In fact, as it is the case for us, 
if the boundary movement is prescribed,
the domain in a \mbox{space-time} context will be a fixed one.
However, 
we disregarded this line of work because it could make the implementation much more complicated.

This ends the literature review regarding the FOM model.
We now present the literature oriented towards the construction of the ROM.

% Uncomment for thesis.tex
\subsubsection{Reduced Basis}
% Uncomment for literature_review.tex
% \subsection{Reduced Basis}
We do not aim here at providing a comprehensive review of the whole field
(for that could be a complete work by itself),
but rather to present a good starting point 
from which the interested reader could start, 
and of course, the framing of this thesis.

A problem's complexity and its computational cost
are typically something that scale together.
Hence, the idea of finding a smaller subspace to represent
the solution and reduce calculation times is justified.

This idea of using a problem-dependent basis with global support 
to solve numerically discretized PDEs
is well known.
The first references in this line date back to the 80s, 
with pioneering works in structural analysis \cite{1978firstRBStructuralAnalysis}.
Since then, this idea has become increasingly popular,
with many papers and books explaining methods and applications for steady and unsteady problems
\cite{Rozza2008, 
2005_aPosterioriErrorBoundsReducedBasisApproximationsParametrizedParabolicPde_Grepl,
2009_reducedBasisMethodsAPosterioriErrorEstimatorsHeatTransferProblems_Rozza,
2016_CertifiedReducedBasisMethodsParametrizedPDE_Hesthaven,
Quarteroni2016,
2017_modelReductionAndApproximation,
benner2017_book},
including the Navier-Stokes equations 
\cite{navierStokesReducedBasis}.
In fact, Burgers' model has been already tackled for a fixed domain
\cite{Nguyen2009}.

In the following,
we present a narrative for Reduced Basis methods in the finite element context,
to frame our use of it.
We understand and admit that there might be other narratives that suit the field,
but the following has proven helpful to understand the ingredients of the ROM.

Our narrative takes the perspective of: where does the basis come from?
Or in other words,
how many mathematical tools are necessary to obtain it?
The construction of the reduced basis needs to take into account the following facts:
there must a sampling strategy in the parameter space,
the reduced basis must converge to the span of the solutions,
and it must be computationally efficient.

The most plain vanilla version of reduced basis is 
a collection of solutions for several parametrizations.
However, the modes of this basis are likely to be almost linearly dependent\footnote{
    A strong assumption underlying reduced basis methods in this context
    is that the solutions of the parametrized PDE
    change smoothly when the parametrization varies.
},
and no approximation arguments have been used to obtain it.

% Greedy
So, the first step one can take is to use a greedy procedure
\cite{Buffa2012APC, Veroy2003}.
That is, the modes of the basis are still solutions of the PDE, 
but they are combined iteratively,
by choosing the next mode which minizimes 
the error made by the current basis within a randomly selected parameter space
(hence the name greedy, in terms of approximation accuracy).
This procedure only requires the finite element discretization,
and one can prove it will converge to the whole span.
The difficulty in this procedure 
is the efficient estimation of the error
of the basis at each iteration.
However, it has become the established method to approach steady models \cite{Haasdonk2013}.

% POD-based
The next step one can take is to rely on an external methodology
to construct the basis from a collection of solution snapshots.
We add an additional item to our mathematical toolbox,
the Singular Value Decomposition (SVD)
\cite{2000_POD_as_SVD},
which allows us to compress the span of the solution space
efficiently with optimal convergence properties.
This is known as the Proper Orthogonal Decomposition (POD) method
\cite{Aubry1991}.
It has been widely used in many contexts 
to obtain a basis from a collection of solutions automatically,
or to analyze the underlying dynamics of a flow field \cite{1987_turbulenceDynamicsCoherentStructures_Sirovich}.

It has a wider application than the greedy method,
since we could use experimental data too, 
to obtain a reduced basis which we then use to solve a numerical model efficiently.
Of particular interest is the application made in
\cite{2003_podBasedReducedOrderModelsWithDeformingGrids_anttonen},
where they used the POD over an analytical solution 
with and without a deforming grid to split effects and analyze convergence rates.

Finally, for unsteady problems one may have the combination of both, 
the \mbox{POD-Greedy} method
\cite{Haasdonk2008, 
Haasdonk2013}.
This method uses the automatic compression feature provided by the POD in the time dimension,
and the greedy approach to parameter selection in the parameter space.

For our work, we will use a physics-driven approach for the sampling strategy in the parameter space,
and a nested POD strategy for the time and parameter spaces \cite{Santo_Manzoni_2019}.

Finally, some words need to be said about the handling of 
the inhomogeneous boundary conditions that we will encounter.
It was difficult to find specific literature about this aspect,
for most papers and books deal with either homogeneous boundary conditions, 
scalar-multiplicative shapes 
\cite{separableBoundaryCondition,
separableBoundaryCondition_Two},
or do not dedicate many lines to this implementation detail.

Neumann boundary conditions do not pose a problem, 
since they are naturally encoded in the weak form.
So a suitable approach is to transfer the essential boundary conditions to the weak form too,
via a lifting technique
\cite{2007_ReducedOrderModelingTimeDependentPDEsMultipleParametersBoundaryData_gunzburger}.
Hence, the target model problem that we reduce 
becomes one with homogeneous boundary conditions,
for which the results from most references apply.

% Uncomment for thesis.tex
\subsubsection{System Approximation}
% Uncomment for literature_review.tex
% \subsection{System Approximation}
We reach now the final block of the literature review.
In this section we review the methodology used to efficiently approximate 
the algebraic operators that arise from the discretization.
% Uncomment for thesis.tex
% As stated in the introduction, this is the reason to add the adjective \textit{hyper} 
% to our Reduced Order Model.
Using an algebraic approach in the reduction scheme is of great advantage,
since then most results can generalize to other discretization schemes.

We start by reviewing the approximation methodology for functions and functionals (vectors).
The one for matrices is its natural extension.

The seeds of the methodology lie in what is called the 
Empirical Interpolation Method (EIM)
\cite{barrault:hal-00021702,
Casenave2014,
Nguyen2008}.
It generates an ad-hoc affine decomposition of a parametrized function,
by splitting the dependency into some real-valued parameter-dependent functions 
and a parameter-independent collateral basis.
The values of the functions are obtained by 
enforcing that certain entries of the vector are 
exactly matched by the ad-hoc decomposition
(hence the name interpolation).
The entries at which the interpolation should be enforced 
are computed during the basis creation,
and they represent those locations where the approximation behaves worse.
The collection of the entries is referred to as the \textit{reduced mesh}.
The collateral basis is generated with function valuations following
a greedy procedure 
\cite{Hesthaven2014}.

As with the RB scenario, 
the generation of the basis can be delegated to a POD procedure,
leading to the Discrete Empirical Interpolation Method (DEIM)
\cite{2010_nonlinearModelReductionDeim_chaturantabut,
2018_podDeimReducedOrderModelDeformingMeshAeroelasticApplications_Donfrancesco}.
Finally, if the columns of a matrix are stacked vertically to \textit{vectorize} it,
a matrix-DEIM method can be used (MDEIM)
\cite{2012_deimAPosterioriNonlinear_DinamicalSystems,
2015_efficientModelReductionParametrizedSystemsMatrixDeim_Negri,
mdeim_elasticity_problems, 
Wirtz2014}.

These approximation methods are convenient in the finite element context.
The calculation of the reduced mesh entries is the sum of evaluations of the 
weak form for a restricted subset of mesh elements.
This operation can be done efficiently in parallel and 
is much cheaper than assembling the whole operator 
\cite{Santo_Manzoni_2019}.
Additionally, the collateral basis can be projected in the reduced space,
so that the reduced operator is approximated right away. 

In all of the above, 
time can be easily included by treating it as an additional parameter,
although the implementation is not so straightforward. 

This concludes our literature review.

% ----------------------


% \subsection{Research Questions}

% \begin{itemize}
%     \item How does the parameter sampling strategy affect the goodness of the POD-basis?
%     \item How does the parameter sampling strategy affect the goodness of the Discrete Empirical Interpolation?
%     \item Can we predict the minimum viable number of basis for a given error?
%     \item What is a representative snapshot, quantitatively?
%     \item What does it mean for a basis to be \textit{rich}? When can we consider the basis sufficiently rich?
%     \item How does the selection of the inner product change the resultant basis of the POD?
%     \item Can we use information from the PDE to improve this inner product?
%     % \item Why does the POD generate basis functions with global support? 
%     \item How do we deal with boundary conditions?
%     \item How do the empirical interpolation error and the reduced basis error affect the final approximation?
%     \item How does the domain deformation problem reduction affect the quality of the reduced solution?
% \end{itemize}

