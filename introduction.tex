\documentclass[thesis.tex]{subfiles}

\newcommand{\inner}[2]{\left<#1, #2\right>}
\newcommand{\alemap}{\ensuremath{\mathcal{A}}}
\newcommand{\dt}{\ensuremath{\Delta t}}
\newcommand{\pexp}{\ensuremath{\frac{2\gamma}{\left(\gamma-1\right)}}}
\newcommand{\aleX}{\ensuremath{\mathcal{X}}}
\newcommand{\Ah}[1]{\ensuremath{\vb{#1}^{n+1}_h}}
\newcommand{\Ahn}[1]{\ensuremath{\vb{#1}^{n}_h}}

\newcommand{\rbV}{\ensuremath{\mathbb{V}}}
\newcommand{\rbVT}{\ensuremath{\rbV^T}}
\newcommand{\epspod}{\ensuremath{\varepsilon_\text{POD}}}

\begin{document}

\section*{List of Symbols}
\addcontentsline{toc}{section}{List of Symbols}

\begin{table}[h]        
    \begin{tabular}{cl}
        % Symbol & Description \\
        % \midrule
        $t$ & time coordinate \\
        $x$ & space coordinate in the physical domain \\
        $\aleX$ & space coordinate in a fixed reference domain \\
        $\alemap$ & Arbitrary Lagrangian Eulerian map \\
        $d$ & mesh displacement \\
        $w_m$ & mesh velocity \\
        $J$ & Jacobian matrix \\
        $J_\alemap$ & Jacobian transformation (matrix determinant) \\
        $L_0$ & initial piston length \\
        $L$ & piston movement in time \\
        $u$ & flow velocity \\
        $\hat{u}$ & flow velocity for the homogeneous problem \\
        $u_h$ & flow velocity finite element representation \\ 
        $g$ & Dirichlet boundary lifting \\ 
        $p$ & pressure \\
        $\rho$ & density \\
        $\gamma$ & specific heat ratio \\
        $MD$ & mass defect in time (numerical integration) \\
        $\varepsilon$ & artificial viscosity value \\
        $\varepsilon_{POD}$ & POD approximation error \\
        $u_p$ & piston mach number \\
        $a_0$ & reference speed of sound \\
        $p_0$ & reference pressure \\
        $\rho_0$ & reference density \\
        $\delta$ & piston displacement from rest \\
        $\omega$ & piston oscillating frequency  \\
        $c$ & dimensionless convection velocity \\
        $b_0$ & dimensionless constant convection coefficient \\
        $b_L$ & dimensionless piston boundary condition \\
        $\mathcal{F}$ & Gaussian bell \\
        $x_c$ & Gaussian bell center \\
        $\sigma_c$ & Gaussian bell dispersion factor \\
        $y_c$ & Gaussian bell scaling factor \\
        $N_h$ & number of finite element degrees of freedom \\ 
        $N$ & number of reduced basis degrees of freedom \\ 
        $V_h$ & space of Lagrangian functions\\ 
        $V_N$ & space of RB solution modes\\ 
        $\varphi_i$ & Lagrangian finite element basis function \\ 
        $\psi_i$ & RB solution modes \\
        $A_{h,q}$ & algebraic operator modes (collateral basis)\\ 
    \end{tabular}
\end{table}

\newpage 
\section{Introduction}
When a painter sets out to paint, she will probably use most of the available basic colours.
However, if she knew beforehand that she was only going to paint landscapes, 
she would fare well with a farsighted palette: greens, browns, blues, whites, etc.
Such is the nature of reduced order models, 
to find a subset among the combinations of basic colours 
to represent the solution to the problem of interest.

In the context of this work, 
the basic colours are the classical mathematical Lagrangian finite element basis functions: 
generic, piecewise, with local support, able to represent most functions of interest.
Instead, the landscape palette will be ad-hoc:
problem-dependent functions with global support, 
good at capturing details only specific to landscapes.

Additionally, she will not need all sorts of brushes, 
simply the ones with the right thickness and width for mountains, trees and hills.
The brushes represent the algebraic operators that arise from the finite element discretization.
As with the colours, we can find a subset of combinations of brushes that suit our problem.
That is, we can find a basis for each algebraic operator to build them efficiently.

Finally, since she is a vanguard painter, the domain of our problem, her canvas, 
will be allowed to change in time as she paints.
The landscape colours and brushes we select will need to take this into account.

So far with metaphors.

\subsection{The Need for Reduction}
Conventional PDE discretization techniques 
(finite elements, finite volumes, finite differences, etc.) 
rely on a generic representation of the PDE solution
to form an algebraic system; 
whose unknowns allow the determination of the PDE solution
at each mesh location and time step. 
The discretized operators which conform these algebraic systems
are often sparse\footnote
{
    Conventional discretization techniques typically 
    use functions with local support to represent the solution.
}
and high-dimensional\footnote
{
    The more mesh nodes are added to the mesh
    (and thus the more unknowns the discretized algebraic system has),
    the closer the discrete PDE solution will get to the continuous PDE solution.
}.
For real-life scenarios, the computational time
required to solve them 
can become prohibitive 
for parameter sweeps or optimization problems
(two tasks which are often an important step of scientific or engineering works).

This leads to the idea of building and using
ad-hoc reduced basis (RB) modes 
to represent the solution, 
in substitution of the generic functions used by conventional methods.
The RB solution modes encode the main dynamics of the PDE,
and thus with a few number of them the solution can be accurately represented.   
The reduced order model (ROM) associated to the RB solution modes is 
obtained by projection of the discretized operators associated 
with the original conventional method.
The resulting linear system is dense,
and several orders of magnitude smaller;
which makes it suitable for many-query tasks.
We refer to the RB mode identification step as the 
\textit{offline stage};
and to its use to solve new problems as the
\textit{online stage}.

\subsubsection{Reduction in a Moving Mesh Context}
In the context of a fixed mesh, 
the assembly and projection steps take place once and for all.
On the contrary, if the mesh moves in time,
these steps need to take place for every time step\footnote
{
    Discrete 
    integrals,
    fluxes, 
    or interpolations 
    associated to the conventional discretization method
    need to be recomputed for the new mesh.
}.
Hence, despite the reduction in size of the linear system,
there is still a considerable overhead during its assembly.
To overcome it, a system approximation technique is introduced,
following the same idea behind RB modes: 
find and use a suitable ad-hoc representation basis;
thus the discrete operator is expressed as 
a linear combination of operator modes (collateral basis).
The system approximation technique must require that 
an efficient assembly of the projected operator can be obtained
at runtime, for each time step.

Since a basis is identified for the solution and each of the algebraic operators,
the combination of these two techniques defines an hyper reduced order model (HROM).
The adjective \mbox{\textit{hyper}}\footnote{
    From Greek \textit{hyper} (prep. and adv.) 
    "over, beyond, overmuch, above measure".
} is present because 
a collateral basis will be created for each algebraic operator,
on top of the one created for the solution space.

To put in practice the ideas previously stated, 
we build and certify an HROM 
for a one-dimensional parametrized piston problem, 
whose movement is prescribed.
The model PDE, the boundary conditions and 
the geometrical configuration are parametrized.
The finite element method is used as the conventional discretization technique.
This work extends 
\cite{Santo_Manzoni_2019,
2015_efficientModelReductionParametrizedSystemsMatrixDeim_Negri}
(albeit for a simpler PDE and domain), 
which did introduce the MDEIM system approximation technique 
for unsteady problems with geometrically parametrized domains, 
although the mesh (and the domain boundary) remained fixed in time.

\subsection{The Modeling Impact of a Moving Mesh}
Physical problems with moving meshes require 
the introduction of a convective term to account for 
the movement of the mesh, 
and potentially a transformation in the finite element weak form.
This transformation translates the integrals 
defined in a deforming space into a fixed, 
numerical grid, 
as shown in Figure~\ref{fig:jacobianTransformation}.
\begin{figure}[h]
    \includegraphics[width=\columnwidth]{research_project/piston/figures/Jacobian_determinant_and_distortion.png}
    \caption{Numerical fixed grid to the left, physical moving mesh to the right.
    The Jacobian determinant establishes the connection between 
    the evaluation of an integral over the square (red) in each domain (blue).
    Figure from \cite{jacobianTransformation}.}
    \label{fig:jacobianTransformation}
\end{figure}

This transformation can take many names, 
such as generalized transformation, 
mapping,
boundary-conforming coordinate transformation,
etc.
% mapping},
It usually involves the computation of a Jacobian matrix $J$,
whose determinant plays an important role in the aforementioned transformation.

The entries of the Jacobian matrix might be known explicitly,
if the deformation is known analytically and the domain is sufficiently simple.
However, if the domain takes arbitrary shapes 
(likely for real-life problems in higher dimensions than one),
or we are dealing with an FSI problem (where the deformation is part of the solution),
it is quite possible that we have to compute the Jacobian transformation numerically.
This is likely to be an undesirable situation, 
for the physical weak form will become contaminated with additional terms, 
making it more cumbersome to implement and deal with\footnote{
    The discretization will not be formulated for the original variable~$\phi$,
    but rather for its distorted counterpart~$J \phi$.
    },
as well as the inevitable overhead in computational costs.

This overhead created by the Jacobian is likely to permeate to the reduced order model (ROM),
for in the context of finite elements, ROMs are often built as a system with the same algebraic structure
as the departing full order model (FOM),
albeit with smaller matrices and vectors. 
It might even be the case that we cannot completely uncouple the ROM from the FOM, 
if the problem is complex enough, or that we need satellite\footnote
{
    If the Jacobian is derived from a PDE, 
    this would require an additional ROM with its corresponding reduced basis to 
    enhance computation times.
} ROMs to compute the Jacobian matrix efficiently.

Hence, to avoid all of the previous, 
we develop a ROM formulation which allows us to remain in the physical domain, 
whilst maintaining a perfect \textit{offline-online} decomposition,
allowing our reduction scheme to reach its maximum efficiency.

\subsection{Literature Review}
We now frame our work within the current body of knowledge 
with a short literature review.
Additional references will be cited within the body of the document, 
where their appearence is more accurate and helpful.  
\input{literature.tex}

\clearpage
\subsection{Research Questions}
In this work we answer the following specific questions to drive our research:
\begin{itemize}
    \item How can the expense of the online application be minimised? 
    This minimization will go through using 
    as little information from the FOM as possible 
    (including using no information at all).
    % [This is what is implied by your perfect online/offline split objective]
    \item How does the type of mesh movement, 
    (e.g. uniform or non-uniform stretching) 
    affect the reducibility of the operator?
    \item How does the nonlinear term affect the hyperreduction?
    Is there more than one way to reduce a nonlinear term?
    \item How do the approximation errors of
    the solution and operators RB basis interact?
    \item How should a moving-domain problem be implemented to 
    ensure a general but relatively compact HROM? 
    % [the lifting procedure and algebraic approach will be parts of the answer to this]
\end{itemize}

\subsection{Document Layout}
    In Section~\ref{sec:fom_definition} we derive the full order model (FOM), 
    that is, the model PDE and its boundary conditions, 
    mesh deformation and 
    the associated Arbitrary Lagrangian Eulerian (ALE) formulation
    in the physical domain,
    both at the continuous and discrete levels.
    In Section~\ref{sec:rom_definition} we explain the details of the reduction scheme, 
    along with the system approximation technique (M)DEIM.

    In Section~\ref{sec:fom_calibration} 
    we examine the FOM parametrization and response, 
    check the discretization convergence rates, and show GCL results.
    In Section~\ref{sec:results_and_certification} we present reduction results
    and certify the reduction scheme with an efficient a posteriori error estimators obtained via model truncation.

    Finally, in Section~\ref{sec:results_and_certification} 
    we present reduction results
    and certify the reduction scheme with 
    an efficient a posteriori error estimators obtained via model truncation.
\end{document}