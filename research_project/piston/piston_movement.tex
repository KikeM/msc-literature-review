% \documentclass[a4paper, technote, compsoc]{IEEEtran}
\documentclass[../../thesis.tex]{subfiles}

\begin{document}

\section{Determination of Piston Movement Law}
Since we are going to impose the movement of the piston, we need to make sure 
we do so in a physically meaningful way.

This appendix is born after making the mistake of believing that any sinusoidal function would do the job.
Since our flow will depart from rest, 
we need to set the piston motion so that for the initial instant the piston will depart from rest too.

To derive the movement, we depart from a force defined by the elemental harmonic functions,
\begin{subequations}
\begin{align}
        A \cos(\omega t) + B \sin(\omega t) &= m \ddot{x}(t), 
        \\
        x(0) &= 0, 
        \\
        \dot{x}(0) &= 0.
\end{align}
\end{subequations}
Integrating in time, we get
\begin{equation}
    \frac{A}{m \omega} \sin(\omega t) - \frac{B}{m \omega} \cos(\omega t) + C_1 = \dot{x}(t).
\end{equation}
If we enforce the initial condition of rest to find the value of the integration constant, 
we will see how we arrive to an incongruency.
\begin{equation}
    - \frac{B}{m \omega} + C_1 = 0 \rightarrow C_1 = \frac{B}{m \omega}.
\end{equation}
If we were to integrate again in time, 
due to the presence of $C_1$ a linear term in time $\sim t$ will show up.
This is senseless, given that we departed from two linear harmonic functions, 
which input and remove energy with fixed frequency and amount from the system. 
Hence a harmonic movement was expected, not a linearly changing in time.

This conflictive result comes from the presence of the sinusoidal term in the definition of the force moving the piston.
If we set $B=0$, the first integration constant will become null, $C_1=0$. 
When this is the case, the linear term vanishes, and we recover a harmonic piston movement,
\begin{equation}
    \frac{A}{m \omega^2} \cos(\omega t) + C_2 = x(t).
\end{equation}
By setting the initial location, we get the value for $C_2$,
\begin{equation}
    x(t) = L_0 - \frac{A}{m \omega^2} \left(1 - \cos(\omega t)\right).
\end{equation}
If we now define $A$ such that $\frac{A}{m \omega^2}$ represents a fraction of the initial piston length, $\delta L_0$, 
we get a compact expression for the piston movement,
\begin{equation}
    x(t) = L_0\left[1 - \delta \left(1 - \cos(\omega t)\right)\right].
\end{equation}

\end{document}